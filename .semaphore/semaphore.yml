version: "v1.0"
name: Example ppls
agent:
  machine:
    type: e1-standard-2
    os_image: ubuntu1804

blocks:
  - name: Fetch deps
    task:
      jobs:
      - name: Download and cache
        commands:
          - cache list          
          - cache has_key elasticsearch-6.2.1 || wget -nc https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-6.2.1.deb
          - cache has_key elasticsearch-6.2.1 || cache store elasticsearch-6.2.1 elasticsearch-6.2.1.deb


  - name: Tests
    task:
      jobs:
      - name: language versions
        commands:
          - cache restore elasticsearch-6.2.1
          - echo "install ES and run tests"
